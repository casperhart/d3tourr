var scatter_widget;(()=>{"use strict";var t,e={467:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ScatterWidget=void 0;var r=i(96);Object.defineProperty(e,"ScatterWidget",{enumerable:!0,get:function(){return r.ScatterWidget}})},96:function(t,e,i){var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ScatterWidget=void 0;var s=o(i(212)),a=i(681),c=i(148),u=i(886),h=function(){function t(t,e,i){this.canvas=document.createElement("canvas"),this.clock=new s.Clock,this.pointsBuffers=[],this.minPointSize=.02;var r=new s.Scene;r.background=new s.Color(268435455);var n=new s.AmbientLight(4210752);r.add(n),this.scene=r,this.canvas.width=e,this.canvas.height=i,this.container=t,this.container.appendChild(this.canvas),this.renderer=new s.WebGLRenderer({canvas:this.canvas}),this.camera=new s.PerspectiveCamera(45,e/i,.01,1e3),this.camera.position.setZ(4),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e,i),this.renderer.render(this.scene,this.camera)}return t.prototype.constructPlot=function(){var t=this;if(3!=this.projectionMatrices[0][0].length)throw new TypeError("Projection matrix must be of dimension 3. got "+this.projectionMatrices[0][0].length);this.colMeans=a.getColMeans(this.dataset),this.pointColours=this.coloursToBufferAttribute(this.mapping.colour);var e=new s.BufferGeometry,i=Math.pow(this.dataset.length,-1/3),r=new s.ShaderMaterial({uniforms:{size:{value:Math.max(i,this.minPointSize)}},vertexShader:c.VERTEX_SHADER,fragmentShader:c.FRAGMENT_SHADER}),n=this.getPointsBuffer(0,this.config.center);e.setAttribute("position",n),this.config.cacheFrames&&this.pointsBuffers.push(n),this.points=new s.Points(e,r),this.points.geometry.setAttribute("color",this.pointColours),this.scene.add(this.points);var o=new s.BufferGeometry,h=new s.LineBasicMaterial({color:0,linewidth:1}),l=this.getAxisLinesBuffer(0);o.setAttribute("position",l),this.axisSegments=new s.LineSegments(o,h),this.scene.add(this.axisSegments),this.orbitControls=new u.OrbitControls(this.camera,this.renderer.domElement),this.clock=new s.Clock,this.time=0,this.oldFrame=-1,this.isPaused=!1,this.container.addEventListener("click",(function(){return t.setIsPaused(!t.isPaused)}),!1)},t.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e,this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e)},t.prototype.renderValue=function(t){this.config=t.config,this.dataset=t.dataset,this.projectionMatrices=t.projectionMatrices,this.mapping=t.mapping,this.constructPlot(),this.animate()},t.prototype.getPointsBuffer=function(t,e){var i=a.multiply(this.dataset,this.projectionMatrices[t]);if(e){var r=a.multiply(this.colMeans,this.projectionMatrices[t]);i=a.centerColumns(i,r)}var n=new Float32Array([].concat.apply([],i));return new s.BufferAttribute(n,3)},t.prototype.getAxisLinesBuffer=function(t){var e=this.projectionMatrices[t].map((function(t){return[0,0,0].concat(t)}));return new s.BufferAttribute(new Float32Array([].concat.apply([],e)),3)},t.prototype.coloursToBufferAttribute=function(t){var e=new s.Color,i=new Float32Array(3*this.dataset.length);if(t.length>0)for(var r=0,n=0;n<t.length;n++)r=3*n,e.set(t[n]),i[r]=e.r,i[r+1]=e.g,i[r+2]=e.b;return new s.BufferAttribute(i,3)},t.prototype.animate=function(){var t=this,e=this.clock.getDelta();this.getIsPaused()||(this.time+=e),this.time>=this.config.duration&&(this.time=0);var i=Math.floor(this.time*this.config.fps);if(i!=this.oldFrame){var r=void 0;null==this.pointsBuffers[i]?(r=this.getPointsBuffer(i,this.config.center),this.config.cacheFrames&&(this.pointsBuffers[i]=r)):r=this.pointsBuffers[i],this.points.geometry.setAttribute("position",r),this.points.geometry.attributes.position.needsUpdate=!0,this.axisSegments.geometry.setAttribute("position",this.getAxisLinesBuffer(i)),this.axisSegments.geometry.attributes.position.needsUpdate=!0,this.oldFrame=i}this.renderer.render(this.scene,this.camera),requestAnimationFrame((function(){return t.animate()}))},t.prototype.getIsPaused=function(){return this.isPaused},t.prototype.setIsPaused=function(t){this.isPaused=t,t||this.animate()},t}();e.ScatterWidget=h},148:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VERTEX_SHADER=e.FRAGMENT_SHADER=void 0,e.FRAGMENT_SHADER="\nvarying float vSize;\nvarying vec3 vColor;\n\nvoid main(){\n    gl_FragColor = vec4( vColor, 1.0 );\n\n    // make points circular\n    float distance = length(2.0 * gl_PointCoord - 1.0);\n    if (distance > 1.0) {\n        discard;\n    }\n}\n",e.VERTEX_SHADER="\nuniform float size;\nattribute vec3 color;\n\nvarying vec3 vColor;\n\nvoid main(){\n    vColor=color;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0);\n    gl_Position = projectionMatrix * mvPosition;\n    gl_PointSize = 200.0 * size / -mvPosition.z;\n}\n"},681:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.centerColumns=e.getColMeans=e.multiply=void 0,e.multiply=function(t,e){for(var i=t.length,r=t[0].length,n=new Array(i),o=0;o<i;++o){var s=new Array(3);n[o]=s;for(var a=t[o],c=0;c<3;++c){for(var u=0,h=0;h<r;++h)u+=a[h]*e[h][c];s[c]=u}}return n},e.getColMeans=function(t){var e=t.length;return[t.reduce((function(t,e){return t.map((function(t,i){return t+e[i]}))})).map((function(t){return t/e}))]},e.centerColumns=function(t,e){return t.map((function(t){return t.map((function(t,i){return t-e[0][i]}))}))}}},i={};function r(t){var n=i[t];if(void 0!==n)return n.exports;var o=i[t]={exports:{}};return e[t].call(o.exports,o,o.exports,r),o.exports}r.m=e,t=[],r.O=(e,i,n,o)=>{if(!i){var s=1/0;for(u=0;u<t.length;u++){for(var[i,n,o]=t[u],a=!0,c=0;c<i.length;c++)(!1&o||s>=o)&&Object.keys(r.O).every((t=>r.O[t](i[c])))?i.splice(c--,1):(a=!1,o<s&&(s=o));a&&(t.splice(u--,1),e=n())}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[i,n,o]},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={499:0};r.O.j=e=>0===t[e];var e=(e,i)=>{var n,o,[s,a,c]=i,u=0;for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(c)var h=c(r);for(e&&e(i);u<s.length;u++)o=s[u],r.o(t,o)&&t[o]&&t[o][0](),t[s[u]]=0;return r.O(h)},i=self.webpackChunkscatter_widget=self.webpackChunkscatter_widget||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var n=r.O(void 0,[841],(()=>r(467)));n=r.O(n),scatter_widget=n})();