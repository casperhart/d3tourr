<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="detourr">
<title>Adding a new display method and widget to {detourr} • detourr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adding a new display method and widget to {detourr}">
<meta property="og:description" content="detourr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">detourr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/adding_a_new_widget.html">Adding a new display method to detourr</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/casperhart/detourr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Adding a new display method and widget to {detourr}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/casperhart/detourr/blob/HEAD/vignettes/adding_a_new_widget.Rmd" class="external-link"><code>vignettes/adding_a_new_widget.Rmd</code></a></small>
      <div class="d-none name"><code>adding_a_new_widget.Rmd</code></div>
    </div>

    
    
<p>{detourr} is designed to be extensible, allowing for the addition of new widgets and display methods independently of existing ones. This vignette details how you can extend {detourr} with your own data visuals.</p>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>{detourr} uses TypeScript (TS) code to define widgets, which needs to be bundled as changes are made. To do this, you will need <a href="https://nodejs.org" class="external-link">node.js</a> and <a href="https://yarnpkg.com" class="external-link">yarn</a> installed.</p>
<p>After cloning this repository, install the node.js dependencies with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">yarn</span> install</span></code></pre></div>
<p>Then bundle the TypeScript code and install {detourr} using:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">yarn</span> run build</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-a-widget">Creating a widget<a class="anchor" aria-label="anchor" href="#creating-a-widget"></a>
</h2>
<p>To get started, we’ll first create a new file <code>srcts/hello_world/index.ts</code> with the following contents:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> HelloWorld {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="dt">containerElement</span><span class="op">:</span> <span class="bu">HTMLDivElement</span><span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="dt">message</span><span class="op">:</span> <span class="bu">HTMLHeadElement</span><span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="dt">el</span><span class="op">:</span> <span class="bu">HTMLDivElement</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> number<span class="op">,</span> <span class="dt">height</span><span class="op">:</span> number) {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> h <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">"h1"</span>)<span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> t <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createTextNode</span>(<span class="st">"Hello, world!"</span>)<span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    h<span class="op">.</span><span class="fu">appendChild</span>(t)<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">message</span> <span class="op">=</span> h<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">resize</span>(width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="fu">renderValue</span>(<span class="dt">inputData</span><span class="op">:</span> any) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">.</span><span class="fu">appendChild</span>(<span class="kw">this</span><span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(inputData)<span class="op">;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="fu">resize</span>(<span class="dt">width</span><span class="op">:</span> number<span class="op">,</span> <span class="dt">height</span><span class="op">:</span> number) {</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">"Width: "</span><span class="op">,</span> width<span class="op">,</span> <span class="st">", Height: "</span><span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here, the <code>HelloWorld</code> widget is created as it’s own class with two public methods: <code>renderValue</code> and <code>resize</code>. The <code>renderValue</code> method takes an argument <code>inputData</code>, which will contain all the data passed from R to our widget including any configuration we need, our data set, and the sequence of projection matrices representing the tour path.</p>
<p>At the moment, all we are doing is logging the data to the browser console. This will will allow us to explore it’s structure when it’s up and running.</p>
</div>
<div class="section level2">
<h2 id="bundling-the-widget">Bundling the widget<a class="anchor" aria-label="anchor" href="#bundling-the-widget"></a>
</h2>
<p>The HTMLWidgets package can’t deal with this Typescript code as-is, so we need to modify our <code>webpack</code> configuration so that it gets transpiled to javascript and bundled when the package is built.</p>
<p>This only requires a small modification to the <code>webpack/package.config.ts</code> to include our TS code as an additional entrypoint:</p>
<p><code>webpack/package.config.ts</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>const path = require("path");</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>const webpack = require("webpack");</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>module.exports = {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  mode: "production",</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  entry: {</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    "display_scatter_2d": "./srcts/display_scatter_2d/index.ts",</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    "display_scatter_3d": "./srcts/display_scatter_3d/index.ts",</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="va">+   "hello_world": "./srcts/hello_world/index.ts",</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  ...</span></code></pre></div>
<p>Now, when we build and install our package using <code>yarn run build</code>, a file <code>hello_world.bundle.js</code> is created in the <code>inst/htmlwidgets/lib</code> folder alongside the existing bundles.</p>
</div>
<div class="section level2">
<h2 id="adding-the-configuration-and-javascript-bindings">Adding the configuration and javascript bindings<a class="anchor" aria-label="anchor" href="#adding-the-configuration-and-javascript-bindings"></a>
</h2>
<p>The steps in this section are very similar to the general example in the <a href="https://www.htmlwidgets.org/develop_intro.html" class="external-link">htmlwidgets documentation</a>, so we will gloss over many of the technical details here.</p>
<p>In short, we require two files for our widget to work: <code>inst/htmlwidgets/hello_world.yaml</code> which contains the configuration, and <code>inst/htmlwidgets/hello_world.js</code> which contains the javascript bindings.</p>
<p>First we’ll set up the configuration file <code>inst/htmlwidgets/hello_world.yaml</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dependencies</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> hello_world </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">src</span><span class="kw">:</span><span class="at"> htmlwidgets/lib/</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0.9</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">script</span><span class="kw">:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">      # these are specified in the order they should load</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> runtime.bundle.js</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> hello_world.bundle.js</span></span></code></pre></div>
<p>Notice the inclusion of <code>runtime.bundle.js</code>. This contains the webpack runtime, and our code won’t run without it. Any external packages that your widget loads will be bundled separately as well, so we need to include them in this file <em>above the main bundle</em>.</p>
<p>For the javascript binding, we need to create the file <code>inst/htmlwidgets/hello_world.js</code>. Because we implemented our widget as a typescript class with <code>renderValue</code> and <code>resize</code> methods, the contents of the javascript binding can remain quite simple even as the widget itself becomes more complex:</p>
<p><code>inst/htmlwidgets/hello_world.js</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>HTMLWidgets<span class="op">.</span><span class="fu">widget</span>({</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"hello_world"</span><span class="op">,</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"output"</span><span class="op">,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">factory</span><span class="op">:</span> <span class="kw">function</span> (el<span class="op">,</span> width<span class="op">,</span> height) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> widget <span class="op">=</span> <span class="kw">new</span> hello_world<span class="op">.</span><span class="fu">HelloWorld</span>(el<span class="op">,</span> width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">renderValue</span><span class="op">:</span> <span class="kw">function</span> (x) {</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                widget<span class="op">.</span><span class="fu">renderValue</span>(x)<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="dt">resize</span><span class="op">:</span> <span class="kw">function</span> (width<span class="op">,</span> height) {</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                widget<span class="op">.</span><span class="fu">resize</span>(width<span class="op">,</span> height)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>            <span class="dt">s</span><span class="op">:</span> widget</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adding-the-display-method-in-r">Adding the display method in R<a class="anchor" aria-label="anchor" href="#adding-the-display-method-in-r"></a>
</h2>
<p>Here we diverge from the <a href="https://www.htmlwidgets.org/develop_intro.html" class="external-link">htmlwidgets documentation</a> a little bit. Rather than creating an R binding directly, we will instead create a new display method called <code>display_hello_world</code>, and let the <code>animate_tour</code> function handle the rest.</p>
<p><code>R/display_hello_world.R</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' Display Hello World Example</span>
<span class="co">#'</span>
<span class="co">#' Note that these comments will be converted in to documentation by the</span>
<span class="co">#' {roxygen2} package when we run `yarn run build`. As such, the `@export`</span>
<span class="co">#' below is necessary, or else this function won't be made available to the</span>
<span class="co">#' user</span>
<span class="co">#'</span>
<span class="co">#' @export</span>
<span class="va">display_hello_world</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">init</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">col_spec</span>, <span class="va">tour_dim</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">data_cols</span> <span class="op">&lt;-</span> <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/eval_select.html" class="external-link">eval_select</a></span><span class="op">(</span><span class="va">col_spec</span>, <span class="va">data</span><span class="op">)</span>
    <span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data_cols</span><span class="op">)</span>

    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      <span class="st">"plot"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
        labels <span class="op">=</span> <span class="va">labels</span>
      <span class="op">)</span>,
      <span class="st">"widget"</span> <span class="op">=</span> <span class="st">"hello_world"</span>,
      <span class="st">"mapping"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">}</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    <span class="st">"init"</span> <span class="op">=</span> <span class="va">init</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The return value of <code>display_hello_world</code> is a list containing an <code>init</code> function which is called within <code>animate_tour</code> in order to get a widget-specific configuration. The input to this function consists of:</p>
<ul>
<li>
<code>data</code>: The input data to use as a data frame. This will contain the numeric columns to use for the tour, as well as any additional columns which may be used for aesthetic mappings.</li>
<li>
<code>col_spec</code>: a quosure specifying which numeric columns to use for the tour. Is evaluated using {tidyselect}</li>
<li>
<code>tour_dim</code>: the output dimension of the tour. E.g. 2, 3</li>
</ul>
<p>The <code>init</code> function is expected to return a list with the following elements:</p>
<ul>
<li>
<code>plot</code>: configuation for the plot. Usually a list.</li>
<li>
<code>widget</code>: the name of the htmlwidget to use as a character value. This must be consistent with what is specified in <code>inst/htmlwidgets/hello_world.yaml</code>.</li>
<li>
<code>mapping</code>: aesthetic mappings for the plot, usually in the format <code>list("aesthetic_name": values)</code>
</li>
</ul>
<p>All the values returned by this function will be passed through to the <code>hello_world</code> widget’s <code>renderValue</code> method, along with additional fields from the <code>animate_tour</code> function such as the dataset and projection matrices.</p>
</div>
<div class="section level2">
<h2 id="trying-it-out">Trying it out<a class="anchor" aria-label="anchor" href="#trying-it-out"></a>
</h2>
<p>Now the hard part is done, we need to bundle everything together and install the package:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">yarn</span> run build</span></code></pre></div>
<p>And then test out the widget in R:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://casperhart.github.io/detourr/">detourr</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/animate_tour.html">animate_tour</a></span><span class="op">(</span><span class="fu">tourr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/tourr/man/Flea-measurements.html" class="external-link">flea</a></span>, <span class="fu"><a href="https://rdrr.io/pkg/tourr/man/grand_tour.html" class="external-link">grand_tour</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fu">display_hello_world</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="images/package_hello_world.png" width="100%"></p>
<p>Success!</p>
<p>If we open up the browser console, we can see the full structure of the data set which is passed in to our widget. We can add additional configuation and aesthetic mappings as we need them by modifying the <code>display_hello_world</code> function:</p>
<p><img src="images/browser_console.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="useful-tips">Useful tips<a class="anchor" aria-label="anchor" href="#useful-tips"></a>
</h2>
<div class="section level3">
<h3 id="extending-existing-widgets">Extending existing widgets<a class="anchor" aria-label="anchor" href="#extending-existing-widgets"></a>
</h3>
<p>A major benefit of having each widget defined as it’s own class is that existing widgets can be extended and modified, which removes the need to create them from scratch.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Casper Hart, Earo Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
